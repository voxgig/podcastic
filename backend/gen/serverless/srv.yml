monitor:
  handler: dist/handler/lambda/monitor.handler
  role: BasicPodmindLambdaRole
  timeout: 30



auth:
  handler: dist/handler/lambda/auth.handler
  role: BasicPodmindLambdaRole
  timeout: 30
  events:
    - http:
        path: "/api/public/auth"
        method: POST
        cors: false





user:
  handler: dist/handler/lambda/user.handler
  role: BasicPodmindLambdaRole
  timeout: 30
  events:
    - http:
        path: "/api/private/user"
        method: POST
        cors: false





entity:
  handler: dist/handler/lambda/entity.handler
  role: BasicPodmindLambdaRole
  timeout: 30
  events:
    - http:
        path: "/api/private/entity"
        method: POST
        cors: false





chat:
  handler: dist/handler/lambda/chat.handler
  role: BasicPodmindLambdaRole
  timeout: 30
  events:
    - http:
        path: "/api/public/chat"
        method: POST
        cors: false





widget:
  handler: dist/handler/lambda/widget.handler
  role: BasicPodmindLambdaRole
  timeout: 30
  events:
    - http:
        path: "/api/public/widget"
        method: POST
        cors: false





ingest:
  handler: dist/handler/lambda/ingest.handler
  role: BasicPodmindLambdaRole
  timeout: 444
  events:
    - sqs:
        arn:
          Fn::GetAtt:
            - QueueAimIngestHandleEpisode
            - Arn
        batchSize: 1
    - sqs:
        arn:
          Fn::GetAtt:
            - QueueAimIngestTranscribeEpisode
            - Arn
        batchSize: 1
    - sqs:
        arn:
          Fn::GetAtt:
            - QueueAimIngestEmbedChunk
            - Arn
        batchSize: 1
    - sqs:
        arn:
          Fn::GetAtt:
            - QueueAimIngestStoreEmbed
            - Arn
        batchSize: 1
    - s3:
        bucket: podmind01-backend01-file01-${self:provider.stage}
        event: s3:ObjectCreated:*
        existing: true
        rules:
          - prefix: folder01/audio01
    - s3:
        bucket: podmind01-backend01-file01-${self:provider.stage}
        event: s3:ObjectCreated:*
        existing: true
        rules:
          - prefix: folder01/transcript01

